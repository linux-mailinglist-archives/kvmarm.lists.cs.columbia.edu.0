Return-Path: <kvmarm-bounces@lists.cs.columbia.edu>
X-Original-To: lists+kvmarm@lfdr.de
Delivered-To: lists+kvmarm@lfdr.de
Received: from mm01.cs.columbia.edu (mm01.cs.columbia.edu [128.59.11.253])
	by mail.lfdr.de (Postfix) with ESMTP id CF6982BA947
	for <lists+kvmarm@lfdr.de>; Fri, 20 Nov 2020 12:36:30 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by mm01.cs.columbia.edu (Postfix) with ESMTP id 6CA8F4B224;
	Fri, 20 Nov 2020 06:36:30 -0500 (EST)
X-Virus-Scanned: at lists.cs.columbia.edu
X-Spam-Flag: NO
X-Spam-Score: -4.091
X-Spam-Level: 
X-Spam-Status: No, score=-4.091 required=6.1 tests=[BAYES_00=-1.9,
	DKIM_SIGNED=0.1, DNS_FROM_AHBL_RHSBL=2.699, RCVD_IN_DNSWL_HI=-5,
	T_DKIM_INVALID=0.01] autolearn=unavailable
Authentication-Results: mm01.cs.columbia.edu (amavisd-new); dkim=softfail
	(fail, message has been altered) header.i=@kernel.org
Received: from mm01.cs.columbia.edu ([127.0.0.1])
	by localhost (mm01.cs.columbia.edu [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id aTVh0Jqyi+lV; Fri, 20 Nov 2020 06:36:30 -0500 (EST)
Received: from mm01.cs.columbia.edu (localhost [127.0.0.1])
	by mm01.cs.columbia.edu (Postfix) with ESMTP id C8AA64B1D9;
	Fri, 20 Nov 2020 06:36:28 -0500 (EST)
Received: from localhost (localhost [127.0.0.1])
 by mm01.cs.columbia.edu (Postfix) with ESMTP id 0295B4B1CD
 for <kvmarm@lists.cs.columbia.edu>; Fri, 20 Nov 2020 06:36:27 -0500 (EST)
X-Virus-Scanned: at lists.cs.columbia.edu
Received: from mm01.cs.columbia.edu ([127.0.0.1])
 by localhost (mm01.cs.columbia.edu [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id oNNWKxSRwNa6 for <kvmarm@lists.cs.columbia.edu>;
 Fri, 20 Nov 2020 06:36:25 -0500 (EST)
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by mm01.cs.columbia.edu (Postfix) with ESMTPS id 6512B4B1B9
 for <kvmarm@lists.cs.columbia.edu>; Fri, 20 Nov 2020 06:36:25 -0500 (EST)
Received: from mail-oi1-f176.google.com (mail-oi1-f176.google.com
 [209.85.167.176])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 138032236F
 for <kvmarm@lists.cs.columbia.edu>; Fri, 20 Nov 2020 11:36:24 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1605872184;
 bh=l22FqpfMhdHqL8kobUx9fWCDmrCGA9joxTifiiwbs0w=;
 h=References:In-Reply-To:From:Date:Subject:To:Cc:From;
 b=YmPQnNjYAb8lvWSlBh2Si9Hz3UmiW5buL12A4zzzAP1pU0QzW2xoVR9f4DC1Aytac
 bZnGX+lkw8APOc2WzHu0CD20rhrBOTCX+pB1kqebS9bLsozzdyB9ROBxQDP1DAsDpE
 jqbMa0BhSFlRkBo0vcukvI4vPKSSZiS+lAFjk0lE=
Received: by mail-oi1-f176.google.com with SMTP id s18so8935466oih.1
 for <kvmarm@lists.cs.columbia.edu>; Fri, 20 Nov 2020 03:36:24 -0800 (PST)
X-Gm-Message-State: AOAM531i+LqXt5tK94cAu76YYZRNg1ETHYpu1ts5ZdJAWay6/pGBnyxI
 D54TrRWGbpPdBTaTcHH2tXBIfujYu/9KITyRbEQ=
X-Google-Smtp-Source: ABdhPJy4smxIDFAdZ/MHfjEYx55tEaD5yvhfyzqfrLOTKir4MlCRoGlCVpDauB4Nb3Y00CqMCGTsiijWE6rrEiUZ0yc=
X-Received: by 2002:aca:5c82:: with SMTP id q124mr6134989oib.33.1605872183139; 
 Fri, 20 Nov 2020 03:36:23 -0800 (PST)
MIME-Version: 1.0
References: <20201113182435.64015-1-andre.przywara@arm.com>
 <20201113182435.64015-5-andre.przywara@arm.com>
 <CAMj1kXFMzSKO7yMRSz55Au_kRr=zLT_2tZA_+JNDfJ+osfjkKg@mail.gmail.com>
 <ecff0731-b007-9e7c-3d1d-ae9bc7b1c92e@arm.com>
In-Reply-To: <ecff0731-b007-9e7c-3d1d-ae9bc7b1c92e@arm.com>
From: Ard Biesheuvel <ardb@kernel.org>
Date: Fri, 20 Nov 2020 12:36:11 +0100
X-Gmail-Original-Message-ID: <CAMj1kXEH0boGErYbBNy3F9h9YYwRbumVeeLV94=1QfZcS6ffdg@mail.gmail.com>
Message-ID: <CAMj1kXEH0boGErYbBNy3F9h9YYwRbumVeeLV94=1QfZcS6ffdg@mail.gmail.com>
Subject: Re: [PATCH v3 4/5] arm64: Add support for SMCCC TRNG entropy source
To: =?UTF-8?Q?Andr=C3=A9_Przywara?= <andre.przywara@arm.com>
Cc: Marc Zyngier <maz@kernel.org>,
 Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>, Theodore Ts'o <tytso@mit.edu>,
 Catalin Marinas <catalin.marinas@arm.com>,
 Linus Walleij <linus.walleij@linaro.org>, Russell King <linux@armlinux.org.uk>,
 Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
 Mark Brown <broonie@kernel.org>, Sudeep Holla <sudeep.holla@arm.com>,
 Will Deacon <will@kernel.org>, kvmarm <kvmarm@lists.cs.columbia.edu>,
 Linux ARM <linux-arm-kernel@lists.infradead.org>
X-BeenThere: kvmarm@lists.cs.columbia.edu
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: Where KVM/ARM decisions are made <kvmarm.lists.cs.columbia.edu>
List-Unsubscribe: <https://lists.cs.columbia.edu/mailman/options/kvmarm>,
 <mailto:kvmarm-request@lists.cs.columbia.edu?subject=unsubscribe>
List-Archive: <https://lists.cs.columbia.edu/pipermail/kvmarm>
List-Post: <mailto:kvmarm@lists.cs.columbia.edu>
List-Help: <mailto:kvmarm-request@lists.cs.columbia.edu?subject=help>
List-Subscribe: <https://lists.cs.columbia.edu/mailman/listinfo/kvmarm>,
 <mailto:kvmarm-request@lists.cs.columbia.edu?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: kvmarm-bounces@lists.cs.columbia.edu
Sender: kvmarm-bounces@lists.cs.columbia.edu

T24gRnJpLCAyMCBOb3YgMjAyMCBhdCAxMTo1MiwgQW5kcsOpIFByenl3YXJhIDxhbmRyZS5wcnp5
d2FyYUBhcm0uY29tPiB3cm90ZToKPgo+IE9uIDE5LzExLzIwMjAgMTM6NDEsIEFyZCBCaWVzaGV1
dmVsIHdyb3RlOgo+Cj4gSGksCj4KPiA+IE9uIEZyaSwgMTMgTm92IDIwMjAgYXQgMTk6MjQsIEFu
ZHJlIFByenl3YXJhIDxhbmRyZS5wcnp5d2FyYUBhcm0uY29tPiB3cm90ZToKPiA+Pgo+ID4+IFRo
ZSBBUk0gYXJjaGl0ZWN0ZWQgVFJORyBmaXJtd2FyZSBpbnRlcmZhY2UsIGRlc2NyaWJlZCBpbiBB
Uk0gc3BlYwo+ID4+IERFTjAwOTgsIGRlZmluZXMgYW4gQVJNIFNNQ0NDIGJhc2VkIGludGVyZmFj
ZSB0byBhIHRydWUgcmFuZG9tIG51bWJlcgo+ID4+IGdlbmVyYXRvciwgcHJvdmlkZWQgYnkgZmly
bXdhcmUuCj4gPj4gVGhpcyBjYW4gYmUgZGlzY292ZXJlZCB2aWEgdGhlIFNNQ0NDID49djEuMSBp
bnRlcmZhY2UsIGFuZCBwcm92aWRlcwo+ID4+IHVwIHRvIDE5MiBiaXRzIG9mIGVudHJvcHkgcGVy
IGNhbGwuCj4gPj4KPiA+PiBIb29rIHRoaXMgU01DIGNhbGwgaW50byBhcm02NCdzIGFyY2hfZ2V0
X3JhbmRvbV8qKCkgaW1wbGVtZW50YXRpb24sCj4gPj4gY29taW5nIHRvIHRoZSByZXNjdWUgd2hl
biB0aGUgQ1BVIGRvZXMgbm90IGltcGxlbWVudCB0aGUgQVJNIHY4LjUgUk5HCj4gPj4gc3lzdGVt
IHJlZ2lzdGVycy4KPiA+Pgo+ID4+IEZvciB0aGUgZGV0ZWN0aW9uLCB3ZSBwaWdneSBiYWNrIG9u
IHRoZSBQU0NJL1NNQ0NDIGRpc2NvdmVyeSAod2hpY2ggZ2l2ZXMKPiA+PiB1cyB0aGUgY29uZHVp
dCB0byB1c2UgKGh2Yy9zbWMpKSwgdGhlbiB0cnkgdG8gY2FsbCB0aGUKPiA+PiBBUk1fU01DQ0Nf
VFJOR19WRVJTSU9OIGZ1bmN0aW9uLCB3aGljaCByZXR1cm5zIC0xIGlmIHRoaXMgaW50ZXJmYWNl
IGlzCj4gPj4gbm90IGltcGxlbWVudGVkLgo+ID4+Cj4gPj4gU2lnbmVkLW9mZi1ieTogQW5kcmUg
UHJ6eXdhcmEgPGFuZHJlLnByenl3YXJhQGFybS5jb20+Cj4gPj4gLS0tCj4gPj4gIGFyY2gvYXJt
NjQvaW5jbHVkZS9hc20vYXJjaHJhbmRvbS5oIHwgNjkgKysrKysrKysrKysrKysrKysrKysrKysr
LS0tLS0KPiA+PiAgMSBmaWxlIGNoYW5nZWQsIDU4IGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9u
cygtKQo+ID4+Cj4gPj4gZGlmZiAtLWdpdCBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vYXJjaHJh
bmRvbS5oIGIvYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9hcmNocmFuZG9tLmgKPiA+PiBpbmRleCBh
YmUwN2MyMWRhOGUuLmZlMzRiZmQzMGNhYSAxMDA2NDQKPiA+PiAtLS0gYS9hcmNoL2FybTY0L2lu
Y2x1ZGUvYXNtL2FyY2hyYW5kb20uaAo+ID4+ICsrKyBiL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20v
YXJjaHJhbmRvbS5oCj4gPj4gQEAgLTQsMTMgKzQsMjQgQEAKPiA+Pgo+ID4+ICAjaWZkZWYgQ09O
RklHX0FSQ0hfUkFORE9NCj4gPj4KPiA+PiArI2luY2x1ZGUgPGxpbnV4L2FybS1zbWNjYy5oPgo+
ID4+ICAjaW5jbHVkZSA8bGludXgvYnVnLmg+Cj4gPj4gICNpbmNsdWRlIDxsaW51eC9rZXJuZWwu
aD4KPiA+PiAgI2luY2x1ZGUgPGFzbS9jcHVmZWF0dXJlLmg+Cj4gPj4KPiA+PiArI2RlZmluZSBB
Uk1fU01DQ0NfVFJOR19NSU5fVkVSU0lPTiAgICAgMHgxMDAwMFVMCj4gPj4gKwo+ID4+ICtleHRl
cm4gYm9vbCBzbWNjY190cm5nX2F2YWlsYWJsZTsKPiA+PiArCj4gPj4gIHN0YXRpYyBpbmxpbmUg
Ym9vbCBfX2luaXQgc21jY2NfcHJvYmVfdHJuZyh2b2lkKQo+ID4+ICB7Cj4gPj4gLSAgICAgICBy
ZXR1cm4gZmFsc2U7Cj4gPj4gKyAgICAgICBzdHJ1Y3QgYXJtX3NtY2NjX3JlcyByZXM7Cj4gPj4g
Kwo+ID4+ICsgICAgICAgYXJtX3NtY2NjXzFfMV9pbnZva2UoQVJNX1NNQ0NDX1RSTkdfVkVSU0lP
TiwgJnJlcyk7Cj4gPj4gKyAgICAgICBpZiAoKHMzMilyZXMuYTAgPCAwKQo+ID4+ICsgICAgICAg
ICAgICAgICByZXR1cm4gZmFsc2U7Cj4gPj4gKwo+ID4+ICsgICAgICAgcmV0dXJuIHJlcy5hMCA+
PSBBUk1fU01DQ0NfVFJOR19NSU5fVkVSU0lPTjsKPiA+PiAgfQo+ID4+Cj4gPj4gIHN0YXRpYyBp
bmxpbmUgYm9vbCBfX2FybTY0X3JuZHIodW5zaWduZWQgbG9uZyAqdikKPiA+PiBAQCAtNDMsMjYg
KzU0LDUyIEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBfX211c3RfY2hlY2sgYXJjaF9nZXRfcmFuZG9t
X2ludCh1bnNpZ25lZCBpbnQgKnYpCj4gPj4KPiA+PiAgc3RhdGljIGlubGluZSBib29sIF9fbXVz
dF9jaGVjayBhcmNoX2dldF9yYW5kb21fc2VlZF9sb25nKHVuc2lnbmVkIGxvbmcgKnYpCj4gPj4g
IHsKPiA+PiArICAgICAgIHN0cnVjdCBhcm1fc21jY2NfcmVzIHJlczsKPiA+PiArCj4gPj4gICAg
ICAgICAvKgo+ID4+ICAgICAgICAgICogT25seSBzdXBwb3J0IHRoZSBnZW5lcmljIGludGVyZmFj
ZSBhZnRlciB3ZSBoYXZlIGRldGVjdGVkCj4gPj4gICAgICAgICAgKiB0aGUgc3lzdGVtIHdpZGUg
Y2FwYWJpbGl0eSwgYXZvaWRpbmcgY29tcGxleGl0eSB3aXRoIHRoZQo+ID4+ICAgICAgICAgICog
Y3B1ZmVhdHVyZSBjb2RlIGFuZCB3aXRoIHBvdGVudGlhbCBzY2hlZHVsaW5nIGJldHdlZW4gQ1BV
cwo+ID4+ICAgICAgICAgICogd2l0aCBhbmQgd2l0aG91dCB0aGUgZmVhdHVyZS4KPiA+PiAgICAg
ICAgICAqLwo+ID4+IC0gICAgICAgaWYgKCFjcHVzX2hhdmVfY29uc3RfY2FwKEFSTTY0X0hBU19S
TkcpKQo+ID4+IC0gICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Cj4gPj4gKyAgICAgICBpZiAo
Y3B1c19oYXZlX2NvbnN0X2NhcChBUk02NF9IQVNfUk5HKSkKPiA+PiArICAgICAgICAgICAgICAg
cmV0dXJuIF9fYXJtNjRfcm5kcih2KTsKPiA+Pgo+ID4+IC0gICAgICAgcmV0dXJuIF9fYXJtNjRf
cm5kcih2KTsKPiA+PiAtfQo+ID4+ICsgICAgICAgaWYgKHNtY2NjX3RybmdfYXZhaWxhYmxlKSB7
Cj4gPj4gKyAgICAgICAgICAgICAgIGFybV9zbWNjY18xXzFfaW52b2tlKEFSTV9TTUNDQ19UUk5H
X1JORDY0LCA2NCwgJnJlcyk7Cj4gPj4gKyAgICAgICAgICAgICAgIGlmICgoaW50KXJlcy5hMCA8
IDApCj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4+Cj4gPj4g
KyAgICAgICAgICAgICAgICp2ID0gcmVzLmEzOwo+ID4+ICsgICAgICAgICAgICAgICByZXR1cm4g
dHJ1ZTsKPiA+PiArICAgICAgIH0KPiA+PiArCj4gPj4gKyAgICAgICByZXR1cm4gZmFsc2U7Cj4g
Pj4gK30KPiA+Pgo+ID4KPiA+IEkgdGhpbmsgd2Ugc2hvdWxkIGJlIG1vcmUgcmlnb3JvdXMgaGVy
ZSBpbiBob3cgd2UgbWFwIHRoZSBjb25jZXB0cyBvZgo+ID4gcmFuZG9tIHNlZWRzIGFuZCByYW5k
b20gbnVtYmVycyBvbnRvIHRoZSB2YXJpb3VzIHNvdXJjZXMuCj4gPgo+ID4gRmlyc3Qgb2YgYWxs
LCBhc3N1bWluZyBteSBwYXRjaCBkcm9wcGluZyB0aGUgY2FsbCB0bwo+ID4gYXJjaF9nZXRfcmFu
ZG9tX3NlZWRfbG9uZygpIGZyb20gYWRkX2ludGVycnVwdF9yYW5kb21uZXNzKCkgZ2V0cwo+ID4g
YWNjZXB0ZWQsIHdlIHNob3VsZCBzd2l0Y2ggdG8gUk5EUlJTIGhlcmUsIGFuZCBpbXBsZW1lbnQg
dGhlIG5vbi1zZWVkCj4gPiB2YXJpYW50cyB1c2luZyBSTkRSLgo+Cj4gSSBhZ3JlZSAoYW5kIGhh
dmUgYSBwYXRjaCByZWFkeSksIGJ1dCB0aGF0IHNlZW1zIGluZGVwZW5kZW50IGZyb20gdGhpcwo+
IHNlcmllcy4KPgoKV2VsbCwgaXQgd2lsbCBjb25mbGljdCwgYnV0IG90aGVyIHRoYW4gdGhhdCwg
SSBhZ3JlZSBpdCBpcyBvcnRob2dvbmFsLgoKPiA+IEhvd2V2ZXIsIHRoaXMgaXMgc3RpbGwgc2Vt
YW50aWNhbGx5IGluYWNjdXJhdGU6IFJORFJSUyBkb2VzIG5vdCByZXR1cm4KPiA+IGEgcmFuZG9t
ICpzZWVkKiwgaXQgcmV0dXJucyBhIG51bWJlciBkcmF3biBmcm9tIGEgZnJlc2hseSBzZWVkZWQK
PiA+IHBzZXVkby1yYW5kb20gc2VxdWVuY2UuIFRoaXMgbWVhbnMgdGhhdCB0aGUgVFJORyBpbnRl
cmZhY2UsIGlmCj4gPiBpbXBsZW1lbnRlZCwgaXMgYSBiZXR0ZXIgY2hvaWNlLCBhbmQgc28gd2Ug
c2hvdWxkIHRyeSBpdCBmaXJzdC4gTm90ZQo+ID4gdGhhdCBvbiBwbGF0Zm9ybXMgdGhhdCBkb24n
dCBpbXBsZW1lbnQgYm90aCwgb25seSBvbmUgb2YgdGhlc2Ugd2lsbCBiZQo+ID4gYXZhaWxhYmxl
IGluIHRoZSBmaXJzdCBwbGFjZS4gQnV0IG9uIHBsYXRmb3JtcyB0aGF0ICpkbyogaW1wbGVtZW50
Cj4gPiBib3RoLCB0aGUgZmlybXdhcmUgaW50ZXJmYWNlIG1heSBhY3R1YWxseSBiZSBsZXNzIHdh
c3RlZnVsIGluIHRlcm1zIG9mCj4gPiByZXNvdXJjZXM6IHRoZSBUUk5HIGludGVyZmFjZSByZXR1
cm5zIGV2ZXJ5IGJpdCBkcmF3biBmcm9tIHRoZQo+ID4gdW5kZXJseWluZyBlbnRyb3B5IHNvdXJj
ZSwgd2hlcmVhcyBSTkRSUlMgdXNlcyB+NTAwIGJpdHMgb2YgZW50cm9weSB0bwo+ID4gcmVzZWVk
IGEgRFJCRyB0aGF0IGdldHMgdXNlZCBvbmx5IG9uY2UgdG8gZHJhdyBhIHNpbmdsZSA2NC1iaXQg
bnVtYmVyLgo+Cj4gSSBhbSBub3Qgc3VyZSBJIHNoYXJlIHlvdXIgZW50aHVzaWFzbSBhYm91dCB0
aGUgcXVhbGl0eSBvZiB0aGUgYWN0dWFsCj4gVFJORyBmaXJtd2FyZSBpbXBsZW1lbnRhdGlvbnMs
IGJ1dCB3ZSBjYW4gZ28gd2l0aCB0aGlzIGZvciBub3cuCj4gTWF5YmUgaWYgd2Ugc2VlIGJhZCBp
bXBsZW1lbnRhdGlvbnMgaW4gdGhlIGZ1dHVyZSwgd2UgY2FuIHJldmlzaXQgdGhpcywKPiBhbmQg
aGF2ZSBzb21lIHR1bmVhYmxlcz8gT3IgYSBjb21tYW5kIGxpbmUgb3B0aW9uIHRvIGlnbm9yZSB0
aGUgU01DQ0MKPiBpbnRlcmZhY2U/IE9yIHVzZSB0aGUgVVVJRCBtZWNoYW5pc20gZm9yIHRoYXQ/
Cj4KClRoaXMgaXMgbm90IGFib3V0IGdvb2Qgb3IgYmFkIGltcGxlbWVudGF0aW9ucy4gSXQgaXMg
YWJvdXQgbWFwcGluZyB0aGUKT1MncyByZXF1ZXN0IGZvciBhIHNlZWQgb250byBhIHByaXZpbGVn
ZWQgZW50cm9weSBzb3VyY2UgaWYgb25lIGlzCmF2YWlsYWJsZSwgaW5zdGVhZCBvZiBvbnRvIGEg
bm9uLXByaXZpbGVnZWQgaW5zdHJ1Y3Rpb24gd2hpY2ggaXMKZG9jdW1lbnRlZCBhcyBwcm9kdWNp
bmcgdGhlIG91dHB1dCBvZiBhIHBzZXVkbyByYW5kb20gbnVtYmVyCmdlbmVyYXRvciwgbm90IG9m
IGFuIGVudHJvcHkgc291cmNlLiBBbmQgYWdhaW4sIGl0IHJlbWFpbnMgdG8gYmUgc2Vlbgp3aGV0
aGVyIGFueSBzeXN0ZW1zIHdpbGwgdHVybiB1cCB0aGF0IGltcGxlbWVudCBib3RoLCBidXQgaWYg
dGhleSBkbywKaXQgbGlrZWx5IG1lYW5zIHRoYXQgdGhlIFNNQyBjYWxsIHByb3ZpZGVzIGFjY2Vz
cyB0byB0aGUgZW50cm9weQpzb3VyY2UgdGhhdCBpcyBhbHNvIHVzZWQgdG8gc2VlZCB0aGUgUk5E
UlJTIERSQkcsIGFuZCBpbiB0aGlzIGNhc2UsCnRoZSBTTUMgY2FsbCBpcyBtb3JlIGFwcHJvcHJp
YXRlLgoKPiA+IEFuZCB0aGUgY29zdCBvZiB0aGUgU01DQ0MgY2FsbCBpbiB0ZXJtcyBvZiBDUFUg
dGltZSBpcyBjaGFyZ2VkIHRvIHRoZQo+ID4gY2FsbGVyLCB3aGljaCBpcyBhcHByb3ByaWF0ZSBo
ZXJlLgo+Cj4gVGhpcyBzdGlsbCBsZWF2ZXMgdGhlIHByb2JsZW0gdGhhdCB0aGUgY29yZSBtaWdo
dCBiZSBzdHVjayBpbiBFTDMgZm9yIGFuCj4gdW5rbm93biBwZXJpb2Qgb2YgdGltZSwgaW1wZWRp
bmcgb3VyIHJlYWx0aW1lIGVmZm9ydHMuCgpJIGFncmVlIHRoYXQgdGhlcmUgbWF5IGJlIHF1YWxp
dHkgb2YgaW1wbGVtZW50YXRpb24gaXNzdWVzIGhlcmUsIGJ1dAp0aGUgY2FsbCBpcyBkb2N1bWVu
dGVkIGFzIG5vbi1ibG9ja2luZywgaS5lLiwgaXQgZWl0aGVyIHJldHVybnMgdGhlCnJlc3VsdCBp
bW1lZGlhdGVseSwgb3IgaXQgc2lnbmFscyBmYWlsdXJlLgoKPiBEbyB3ZSBoYXZlIHNvbWUgYmFs
bCBwYXJrIG51bWJlciBvZiBhIG51bWJlciBvZiBjeWNsZXMgc3BlbnQgaW4gRUwzCj4gc3RpbGwg
YmVpbmcgYWNjZXB0YWJsZT8gVGhhdCBjb3VsZCBzZXJ2ZSBhcyBhIGd1aWRlbGluZSBmb3IgZmly
bXdhcmUKPiBpbXBsZW1lbnRhdGlvbnM/Cj4KClJlYWx0aW1lIGlzIHR5cGljYWxseSBhYm91dCBo
YXZpbmcgYSBib3VuZGVkIHdvcnN0IGNhc2UsIGFuZCBzbyBJCnRoaW5rIHRoZSBub24tYmxvY2tp
bmcgcmVxdWlyZW1lbnQgaXMgd2hhdCBpcyBtb3N0IGltcG9ydGFudCBoZXJlLiBIb3cKbWFueSBj
eWNsZXMgb3IgbmFub3NlY29uZHMgYXJlIHNwZW50IGV4YWN0bHkgaXMgb2YgYSBsZXNzZXIgY29u
Y2VybgpJTU8uCgo+ID4gVGhlbiwgSSBkb24ndCB0aGluayB3ZSBzaG91bGQgZXZlciByZXR1cm4g
ZmFsc2Ugd2l0aG91dCBldmVuIHRyeWluZyBpZgo+ID4gUk5EUlJTIGlzIGF2YWlsYWJsZSBpZiB0
aGUgU01DQ0MgaW52b2NhdGlvbiBmYWlscy4KPgo+IFRoYXQncyBhIGdvb2QgcG9pbnQuCj4KPiA+
IFNvbWV0aGluZyBsaWtlIHRoaXMgcGVyaGFwcz8KPiA+Cj4gPiBpZiAoc21jY2NfdHJuZ19hdmFp
bGFibGUpIHsKPiA+ICAgYXJtX3NtY2NjXzFfMV9pbnZva2UoQVJNX1NNQ0NDX1RSTkdfUk5ENjQs
IDY0LCAmcmVzKTsKPiA+ICAgaWYgKChpbnQpcmVzLmEwID49IDApIHsKPiA+ICAgICAqdiA9IHJl
cy5hMzsKPiA+ICAgICByZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gfQo+Cj4geWVhaCwgdGhlIGZh
bGwtdGhyb3VnaCBoZXJlIGlzIGEgZ29vZCBpZGVhLgo+Cj4gPgo+ID4gaWYgKGNwdXNfaGF2ZV9j
b25zdF9jYXAoQVJNNjRfSEFTX1JORykpCj4gPiAgICByZXR1cm4gX19hcm02NF9ybmRycnModik7
Cj4gPgo+ID4gcmV0dXJuIGZhbHNlOwo+Cj4gU28gSSB3b25kZXIgaWYgd2UgaGF2ZSBhIHRyYWRl
LW9mZiBoZXJlIGJldHdlZW4gdGhlIHBlcmZvcm1hbmNlIG9mIHRoZQo+IFJORFJSUyBlbnRyb3B5
IHNvdXJjZSBhbmQgdGhlIGxhdGVuY3kgb2YgdGhlIGZpcm13YXJlIGltcGxlbWVudGF0aW9uLgo+
IElmIHRoZSBSTkRSIGVudHJvcHkgc291cmNlIGRlbGl2ZXJzIE1iaXRzL3MgKHRoZSBKdW5vIGgv
dyBkZWZpbml0ZWx5Cj4gZG9lcyksIHdlIG1pZ2h0IGp1c3Qgbm90IGNhcmUgYWJvdXQgdGhyb3dp
bmcgYXdheSBzb21lIChvciBldmVuIHRoZQo+IG1ham9yaXR5KSBvZiBpdC4KPgoKVGhlIGltcG9y
dGFudCBkaXN0aW5jdGlvbiBoZXJlIGlzIHRoYXQgeW91IGNhbiBvbmx5IHdhc3RlIHlvdXIgb3du
IENQVQpjeWNsZXMsIGJ1dCB5b3UgY2FuIHBvdGVudGlhbGx5IHdhc3RlIGEgc2hhcmVkIHJlc291
cmNlIGJ5IGhpdHRpbmcgb24KUk5EUlJTIChhbmQgdGhlIGFyY2hpdGVjdHVyZSBkb2VzIG5vdCBn
aXZlIGFueSBndWlkYW5jZSB3aGF0c29ldmVyIG9uCnRoZSBwZXJtaXR0ZWQgZmFpbHVyZSByYXRl
IG9mIFJORFJSUykKCkJ1dCBwZXJoYXBzIHdlIHNob3VsZCBzYXZlIHRoaXMgZGlzY3Vzc2lvbiBm
b3IgYW5vdGhlciB0aW1lLCB3aGVuIHdlCmhhdmUgYWN0dWFsIGhhcmR3YXJlIHRvIHRlc3QgdGhp
cyBvbi4gSW4gdGhlIG1lYW50aW1lLCBJIGFtIGZpbmUgd2l0aAp0aGUgY3VycmVudCBwcmVjZWRl
bmNlIG9mIFJORFJbUlNdIG92ZXIgdGhlIFNNQyBjYWxsLgoKPiBPbiB0aGUgb3RoZXIgaGFuZCB0
aGUgSnVubyBUUk5HIGhhcmR3YXJlIGZvciBpbnN0YW5jZSBzcGVuZHMgYWxyZWFkeQo+IGh1bmRy
ZWRzIG9mIGN5Y2xlcyBvbiBhIHNpbmdsZSAzMi1iaXQgTU1JTyByZWFkIGFsb25lLCBqdXN0IHRv
IHRyYW5zZmVyCj4gdGhlIGJpdHMgaW50byB0aGUgQ1BVLiBIYXZpbmcgYSByYXRoZXIgbGFyZ2Ug
cG9vbCBjb3VsZCBhdm9pZCBwYXlpbmcKPiB0aGlzIHByaWNlIG9uIGV2ZXJ5IFNNQyBjYWxsLCBi
dXQgSSBkb24ndCBzZWUgYSBuaWNlIHdheSBvZiBhbGxvd2luZwo+IFRGLUEgdG8gZmlsbCB0aGlz
IHBvb2wsIHdoZW4gTGludXggdGhpbmtzIGl0IGNhbiBzcGFyZSB0aGUgdGltZS4KPgo+IFNvIEkg
YW0gYSBiaXQgdW5lYXN5IGFib3V0IHVuY29uZGl0aW9uYWxseSBwcmVmZXJyaW5nIHRoZSBTTUND
Qwo+IGltcGxlbWVudGF0aW9uIG92ZXIgdGhlIFJORFJSUyBpbnN0cnVjdGlvbi4KPgo+IENoZWVy
cywKPiBBbmRyZQo+Cj4gPiAoYW5kIHNvbWV0aGluZyBzaW1pbGFyIDJ4IGJlbG93KQo+ID4KPiA+
Cj4gPj4gIHN0YXRpYyBpbmxpbmUgYm9vbCBfX211c3RfY2hlY2sgYXJjaF9nZXRfcmFuZG9tX3Nl
ZWRfaW50KHVuc2lnbmVkIGludCAqdikKPiA+PiAgewo+ID4+ICsgICAgICAgc3RydWN0IGFybV9z
bWNjY19yZXMgcmVzOwo+ID4+ICAgICAgICAgdW5zaWduZWQgbG9uZyB2YWw7Cj4gPj4gLSAgICAg
ICBib29sIG9rID0gYXJjaF9nZXRfcmFuZG9tX3NlZWRfbG9uZygmdmFsKTsKPiA+Pgo+ID4+IC0g
ICAgICAgKnYgPSB2YWw7Cj4gPj4gLSAgICAgICByZXR1cm4gb2s7Cj4gPj4gKyAgICAgICBpZiAo
Y3B1c19oYXZlX2NvbnN0X2NhcChBUk02NF9IQVNfUk5HKSkgewo+ID4+ICsgICAgICAgICAgICAg
ICBpZiAoYXJjaF9nZXRfcmFuZG9tX3NlZWRfbG9uZygmdmFsKSkgewo+ID4+ICsgICAgICAgICAg
ICAgICAgICAgICAgICp2ID0gdmFsOwo+ID4+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biB0cnVlOwo+ID4+ICsgICAgICAgICAgICAgICB9Cj4gPj4gKyAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKPiA+PiArICAgICAgIH0KPiA+PiArCj4gPj4gKyAgICAgICBpZiAoc21jY2NfdHJu
Z19hdmFpbGFibGUpIHsKPiA+PiArICAgICAgICAgICAgICAgYXJtX3NtY2NjXzFfMV9pbnZva2Uo
QVJNX1NNQ0NDX1RSTkdfUk5ENjQsIDMyLCAmcmVzKTsKPiA+PiArICAgICAgICAgICAgICAgaWYg
KChpbnQpcmVzLmEwIDwgMCkKPiA+PiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFs
c2U7Cj4gPj4gKwo+ID4+ICsgICAgICAgICAgICAgICAqdiA9IHJlcy5hMyAmIEdFTk1BU0soMzEs
IDApOwo+ID4+ICsgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKPiA+PiArICAgICAgIH0KPiA+
PiArCj4gPj4gKyAgICAgICByZXR1cm4gZmFsc2U7Cj4gPj4gIH0KPiA+Pgo+ID4+ICBzdGF0aWMg
aW5saW5lIGJvb2wgX19pbml0IF9fZWFybHlfY3B1X2hhc19ybmRyKHZvaWQpCj4gPj4gQEAgLTc3
LDEwICsxMTQsMjAgQEAgYXJjaF9nZXRfcmFuZG9tX3NlZWRfbG9uZ19lYXJseSh1bnNpZ25lZCBs
b25nICp2KQo+ID4+ICB7Cj4gPj4gICAgICAgICBXQVJOX09OKHN5c3RlbV9zdGF0ZSAhPSBTWVNU
RU1fQk9PVElORyk7Cj4gPj4KPiA+PiAtICAgICAgIGlmICghX19lYXJseV9jcHVfaGFzX3JuZHIo
KSkKPiA+PiAtICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4+ICsgICAgICAgaWYgKF9f
ZWFybHlfY3B1X2hhc19ybmRyKCkpCj4gPj4gKyAgICAgICAgICAgICAgIHJldHVybiBfX2FybTY0
X3JuZHIodik7Cj4gPj4gKwo+ID4+ICsgICAgICAgaWYgKHNtY2NjX3RybmdfYXZhaWxhYmxlKSB7
Cj4gPj4gKyAgICAgICAgICAgICAgIHN0cnVjdCBhcm1fc21jY2NfcmVzIHJlczsKPiA+Pgo+ID4+
IC0gICAgICAgcmV0dXJuIF9fYXJtNjRfcm5kcih2KTsKPiA+PiArICAgICAgICAgICAgICAgYXJt
X3NtY2NjXzFfMV9pbnZva2UoQVJNX1NNQ0NDX1RSTkdfUk5ENjQsIDY0LCAmcmVzKTsKPiA+PiAr
ICAgICAgICAgICAgICAgaWYgKChpbnQpcmVzLmEwID49IDApIHsKPiA+PiArICAgICAgICAgICAg
ICAgICAgICAgICAqdiA9IHJlcy5hMzsKPiA+PiArICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gdHJ1ZTsKPiA+PiArICAgICAgICAgICAgICAgfQo+ID4+ICsgICAgICAgfQo+ID4+ICsKPiA+
PiArICAgICAgIHJldHVybiBmYWxzZTsKPiA+PiAgfQo+ID4+ICAjZGVmaW5lIGFyY2hfZ2V0X3Jh
bmRvbV9zZWVkX2xvbmdfZWFybHkgYXJjaF9nZXRfcmFuZG9tX3NlZWRfbG9uZ19lYXJseQo+ID4+
Cj4gPj4gLS0KPiA+PiAyLjE3LjEKPiA+Pgo+Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCmt2bWFybSBtYWlsaW5nIGxpc3QKa3ZtYXJtQGxpc3RzLmNzLmNv
bHVtYmlhLmVkdQpodHRwczovL2xpc3RzLmNzLmNvbHVtYmlhLmVkdS9tYWlsbWFuL2xpc3RpbmZv
L2t2bWFybQo=
