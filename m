Return-Path: <kvmarm-bounces@lists.cs.columbia.edu>
X-Original-To: lists+kvmarm@lfdr.de
Delivered-To: lists+kvmarm@lfdr.de
Received: from mm01.cs.columbia.edu (mm01.cs.columbia.edu [128.59.11.253])
	by mail.lfdr.de (Postfix) with ESMTP id C051D33BD35
	for <lists+kvmarm@lfdr.de>; Mon, 15 Mar 2021 15:36:44 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by mm01.cs.columbia.edu (Postfix) with ESMTP id 73FE74B3AF;
	Mon, 15 Mar 2021 10:36:44 -0400 (EDT)
X-Virus-Scanned: at lists.cs.columbia.edu
X-Spam-Flag: NO
X-Spam-Score: -4.201
X-Spam-Level: 
X-Spam-Status: No, score=-4.201 required=6.1 tests=[BAYES_00=-1.9,
	DNS_FROM_AHBL_RHSBL=2.699, RCVD_IN_DNSWL_HI=-5] autolearn=unavailable
Received: from mm01.cs.columbia.edu ([127.0.0.1])
	by localhost (mm01.cs.columbia.edu [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id QjOaxqsivzy0; Mon, 15 Mar 2021 10:36:43 -0400 (EDT)
Received: from mm01.cs.columbia.edu (localhost [127.0.0.1])
	by mm01.cs.columbia.edu (Postfix) with ESMTP id 533504B680;
	Mon, 15 Mar 2021 10:36:43 -0400 (EDT)
Received: from localhost (localhost [127.0.0.1])
 by mm01.cs.columbia.edu (Postfix) with ESMTP id F2D634B4E3
 for <kvmarm@lists.cs.columbia.edu>; Mon, 15 Mar 2021 10:36:41 -0400 (EDT)
X-Virus-Scanned: at lists.cs.columbia.edu
Received: from mm01.cs.columbia.edu ([127.0.0.1])
 by localhost (mm01.cs.columbia.edu [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 7BJ2KjJOCsSq for <kvmarm@lists.cs.columbia.edu>;
 Mon, 15 Mar 2021 10:36:40 -0400 (EDT)
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by mm01.cs.columbia.edu (Postfix) with ESMTPS id 27A994B5D2
 for <kvmarm@lists.cs.columbia.edu>; Mon, 15 Mar 2021 10:36:40 -0400 (EDT)
Received: from disco-boy.misterjones.org (disco-boy.misterjones.org
 [51.254.78.96])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 3788465012;
 Mon, 15 Mar 2021 14:36:39 +0000 (UTC)
Received: from 78.163-31-62.static.virginmediabusiness.co.uk ([62.31.163.78]
 helo=why.misterjones.org)
 by disco-boy.misterjones.org with esmtpsa (TLS1.3) tls
 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (Exim 4.94)
 (envelope-from <maz@kernel.org>)
 id 1lLoKg-001hZH-Dt; Mon, 15 Mar 2021 14:36:36 +0000
Date: Mon, 15 Mar 2021 14:36:33 +0000
Message-ID: <87czw0fpqm.wl-maz@kernel.org>
From: Marc Zyngier <maz@kernel.org>
To: Shameerali Kolothum Thodi <shameerali.kolothum.thodi@huawei.com>
Subject: Re: [PATCH 7/8] KVM: arm64: Workaround firmware wrongly advertising
 GICv2-on-v3 compatibility
In-Reply-To: <d38d4dc684f94221bdf5ca35b8f66cfc@huawei.com>
References: <87eegtzbch.wl-maz@kernel.org>
 <20210305185254.3730990-1-maz@kernel.org>
 <20210305185254.3730990-8-maz@kernel.org>
 <d38d4dc684f94221bdf5ca35b8f66cfc@huawei.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
X-SA-Exim-Connect-IP: 62.31.163.78
X-SA-Exim-Rcpt-To: shameerali.kolothum.thodi@huawei.com, pbonzini@redhat.com,
 alexandru.elisei@arm.com, andre.przywara@arm.com, ascull@google.com,
 catalin.marinas@arm.com, christoffer.dall@arm.com, Howard.Zhang@arm.com,
 justin.he@arm.com, mark.rutland@arm.com, qperret@google.com,
 suzuki.poulose@arm.com, will@kernel.org, james.morse@arm.com,
 julien.thierry.kdev@gmail.com, kernel-team@android.com,
 linux-arm-kernel@lists.infradead.org, kvmarm@lists.cs.columbia.edu,
 kvm@vger.kernel.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org);
 SAEximRunCond expanded to false
Cc: "kernel-team@android.com" <kernel-team@android.com>,
 Jia He <justin.he@arm.com>, "kvm@vger.kernel.org" <kvm@vger.kernel.org>,
 Will Deacon <will@kernel.org>, Catalin Marinas <catalin.marinas@arm.com>,
 Howard Zhang <Howard.Zhang@arm.com>, Andre Przywara <andre.przywara@arm.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 "kvmarm@lists.cs.columbia.edu" <kvmarm@lists.cs.columbia.edu>,
 "linux-arm-kernel@lists.infradead.org" <linux-arm-kernel@lists.infradead.org>
X-BeenThere: kvmarm@lists.cs.columbia.edu
X-Mailman-Version: 2.1.14
Precedence: list
List-Id: Where KVM/ARM decisions are made <kvmarm.lists.cs.columbia.edu>
List-Unsubscribe: <https://lists.cs.columbia.edu/mailman/options/kvmarm>,
 <mailto:kvmarm-request@lists.cs.columbia.edu?subject=unsubscribe>
List-Archive: <https://lists.cs.columbia.edu/pipermail/kvmarm>
List-Post: <mailto:kvmarm@lists.cs.columbia.edu>
List-Help: <mailto:kvmarm-request@lists.cs.columbia.edu?subject=help>
List-Subscribe: <https://lists.cs.columbia.edu/mailman/listinfo/kvmarm>,
 <mailto:kvmarm-request@lists.cs.columbia.edu?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: kvmarm-bounces@lists.cs.columbia.edu
Sender: kvmarm-bounces@lists.cs.columbia.edu

On Mon, 15 Mar 2021 12:55:42 +0000,
Shameerali Kolothum Thodi <shameerali.kolothum.thodi@huawei.com> wrote:
> 
> 
> 
> > -----Original Message-----
> > From: Marc Zyngier [mailto:maz@kernel.org]
> > Sent: 05 March 2021 18:53
> > To: Paolo Bonzini <pbonzini@redhat.com>
> > Cc: Alexandru Elisei <alexandru.elisei@arm.com>; Andre Przywara
> > <andre.przywara@arm.com>; Andrew Scull <ascull@google.com>; Catalin
> > Marinas <catalin.marinas@arm.com>; Christoffer Dall
> > <christoffer.dall@arm.com>; Howard Zhang <Howard.Zhang@arm.com>; Jia
> > He <justin.he@arm.com>; Mark Rutland <mark.rutland@arm.com>; Quentin
> > Perret <qperret@google.com>; Shameerali Kolothum Thodi
> > <shameerali.kolothum.thodi@huawei.com>; Suzuki K Poulose
> > <suzuki.poulose@arm.com>; Will Deacon <will@kernel.org>; James Morse
> > <james.morse@arm.com>; Julien Thierry <julien.thierry.kdev@gmail.com>;
> > kernel-team@android.com; linux-arm-kernel@lists.infradead.org;
> > kvmarm@lists.cs.columbia.edu; kvm@vger.kernel.org
> > Subject: [PATCH 7/8] KVM: arm64: Workaround firmware wrongly advertising
> > GICv2-on-v3 compatibility
> > 
> > It looks like we have broken firmware out there that wrongly advertises
> > a GICv2 compatibility interface, despite the CPUs not being able to deal
> > with it.
> > 
> > To work around this, check that the CPU initialising KVM is actually able
> > to switch to MMIO instead of system registers, and use that as a
> > precondition to enable GICv2 compatibility in KVM.
> > 
> > Note that the detection happens on a single CPU. If the firmware is
> > lying *and* that the CPUs are asymetric, all hope is lost anyway.
> > 
> > Reported-by: Shameerali Kolothum Thodi
> > <shameerali.kolothum.thodi@huawei.com>
> > Tested-by: Shameer Kolothum <shameerali.kolothum.thodi@huawei.com>
> > Signed-off-by: Marc Zyngier <maz@kernel.org>
> 
> Is it possible to add stable tag for this? Looks like we do have
> systems out there and reports issues.

It is already merged. Which kernel versions do you need that for? In
any case, please submit the backports, and I'll review them.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.
_______________________________________________
kvmarm mailing list
kvmarm@lists.cs.columbia.edu
https://lists.cs.columbia.edu/mailman/listinfo/kvmarm
